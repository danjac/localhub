{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% load i18n %}
{% load rules %}
{% load communities_tags %}

{% get_available_community_count user as communities_count %}

<ul class="menu">
    {% if community %}
    <li class="menu-item">
        <a href="{% url 'activities:home_page' %}">{% trans "Home" %}
        </a>
    </li>
    {% if communities_count > 1 %}
    <li class="menu-item">
        <a href="{% url 'community_list' %}">{% trans "Local Network" %}</a>
    </li>
    {% endif %}
    {% if community %}
    {% test_rule "communities.is_member" user community as is_member %}
    {% has_perm "communities.manage_community" user community as can_manage_community %}
    {% if is_member %}
    <li class="menu-item">
        <a data-controller="active-link" href="{{ user.get_absolute_url }}">{% trans "My Profile" %}</a>
    </li>
    {% endif %}
    <li class="menu-item">
      {% include "includes/mode_toggle.html" %}
    </li>
    {% if can_manage_community %}
    <li class="menu-item"><a href="{% url 'communities:community_update' %}">{% trans "Community Settings" %}</a></li>
    {% endif %}
    {% endif %}

    {% endif %}
    <li class="menu-item">
        <a data-controller="active-link" href="{% url 'user_update' %}">{% trans "My Settings" %}</a>
    </li>
    <li class="menu-item">
        <a data-controller="active-link" href="{% url 'account_email' %}">{% trans "Email Addresses" %}</a>
    </li>
    <li class="menu-item">
        <a data-controller="active-link" href="{% url 'account_change_password' %}">{% trans "Change Password" %}</a>
    </li>

    {% if community %}
    {% test_rule "communities.is_member" user community as is_member %}
    {% if is_member %}
    <li class="menu-item">
        <a href="{% url 'communities:membership_leave' %}">{% trans "Leave Community" %}</a>
    </li>
    {% endif %}
    {% endif %}
    <li class="menu-item">
        <a data-controller="active-link" href="{% url 'user_delete' %}">{% trans "Delete Account" %}</a>
    </li>
</ul>

