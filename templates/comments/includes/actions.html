{% load i18n %}
{% load rules %}

{% has_perm "comments.change_comment" user comment as can_change_comment %}
{% has_perm "comments.delete_comment" user comment as can_delete_comment %}
{% has_perm "comments.like_comment" user comment as can_like_comment %}
{% has_perm "comments.flag_comment" user comment as can_flag_comment %}

<div class="btn-group">
    {% if can_like_comment %}
    <button class="btn btn-sm{% if comment.has_liked %} d-hide{% endif %}"
            id="comment-like-btn-{{ comment.id }}"
            data-controller="ajax"
            data-action="ajax#post"
            data-ajax-url="{% url 'comments:like' comment.id %}"
            data-ajax-toggle="#comment-dislike-btn-{{ comment.id }}"
            >{% trans "Like" %}</button>
    <button class="btn btn-sm{% if not comment.has_liked %} d-hide{% endif %}"
            id="comment-dislike-btn-{{ comment.id }}"
            data-controller="ajax"
            data-action="ajax#post"
            data-ajax-url="{% url 'comments:dislike' comment.id %}"
            data-ajax-toggle="#comment-like-btn-{{ comment.id }}"
            >{% trans "Unlike" %}</button>
    {% endif %}

    {% if can_flag_comment and not comment.has_flagged %}
    <a class="btn btn-sm" href="{% url 'comments:flag' comment.id %}">
        {% trans "Flag" %}
    </a>
    {% endif %}


    {% if can_change_comment %}
    <a class="btn btn-sm" href="{% url 'comments:update' comment.id %}">
        {% trans "Edit" %}
    </a>
    {% endif %}

    {% if can_delete_comment %}
    {% url 'comments:delete' comment.id as delete_url %}
    <a class="btn btn-sm"
       href="{{ delete_url }}"
       data-controller="ajax confirm"
       data-action="confirm#check ajax#delete"
       {% if not is_detail %}
       data-ajax-redirect="{{ request.get_full_path }}"
       {% endif %}
       data-confirm-header="{% trans 'Delete Comment' %}"
       data-confirm-body="{% trans 'Are you sure you want to delete this comment?' %}"
       >
       {% trans "Delete" %}
    </a>
    {% endif %}
</div>

