{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "activities/base.html" %}
{% load i18n %}
{% load rules %}
{% load subscriptions_tags %}

{% block subtitle %} #{{ tag.slug }}{% endblock %}
{% block content %}

{% has_perm "subscriptions.create_subscription" user community as can_create_subscription %}
{% is_subscribed user community tag as is_subscribed %}

{% if can_create_subscription %}
<div class="float-right">
  {% if is_subscribed %}
  <a href="{% url 'activities:unsubscribe_tag' tag.slug %}"
     class="btn btn-sm"
     data-controller="ajax"
     data-action="ajax#post">
    {% trans "Unfollow" %}
  </a>
  {% else %}
  <a href="{% url 'activities:subscribe_tag' tag.slug %}"
     class="btn btn-sm"
     data-controller="ajax"
     data-action="ajax#post">
    {% trans "Follow" %}
  </a>
  {% endif %}
</div>
<div class="clearfix"></div>
{% endif %}


<h3>#{{ tag.slug }}</h3>
{% with total=paginator.count %}
<h4 class="text-gray">{% blocktrans count counter=total %}{{ total }} result{% plural %}{{ total }} results{% endblocktrans %}</h4>
{% endwith %}

{% for activity in object_list %}
<div class="mt-2">
  {% include "activities/includes/activity.html" %}
</div>
{% empty %}
<div class="empty">
  <p class="empty-title h5">{% trans "Sorry, no results found for this tag" %}</p>
</div>
{% endfor %}

{% include "includes/pagination.html" %}
{% endblock content %}
